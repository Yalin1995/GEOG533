---
title: "Bivariate Regression"
author: "Dr. Qiusheng Wu"
output: 
  html_notebook: 
    toc: yes
    toc_float: yes
---

## Example 1

### Problem 

A record company boss was interested in predicting record sales from advertising.

* Data:

    + 200 different album releases
  
* Outcome variable:

    + Sales (CDs and downloads) in the week after release

* Predictor variable:

    + The amount (in units of $1000) spent promoting the record before release.


### Solutioin

```{r}
# url <- "http://spatial.binghamton.edu/geog533/data/AlbumSales1.csv"
url <- "AlbumSales1.csv"
df <- read.csv(url,header = TRUE)
library(knitr)
kable(head(df,n = 10))

plot(df)
m <- lm(df$sales ~ df$adverts)
m
m <- lm(sales ~ adverts, data = df)
summary(m)
abline(m,col="red",lwd=2)
attributes(m)

```

The equation is: $sales = a + b\times adverts = 134.1399 + 0.0961 \times adverts$

## Example 2

Speed and Stopping Distances of Cars

```{r}
df <- cars
library(knitr)
kable(head(df,n = 10))
plot(df)
x <- cars$speed
y <- cars$dist
plot(y ~ x)
m <- lm(y~x)
m
summary(m)

abline(m,col="red",lwd=2)
segments(x,fitted(m),x,y,col="blue",lty = "dashed")

result <- cor.test(x,y,method = "pearson")
result
r <- result$estimate
r2 <- r^2
round(r2,4)
p=1
n=nrow(df)
adjusted.r2 <- r2-(1-r2)*p/(n-p-1)
round(adjusted.r2,4)

```


Make predictions based on new inputs:

```{r}
df <- cars
m <- lm(dist~speed,data = df)
n <- nrow(df)
df$x <- sample(10:100,size = n)
df$y <- predict(m,newdata = data.frame(speed=df$x))
library(knitr)
kable(head(df,n = 10))
plot(df$x,df$y)
abline(m,col="red")

```

